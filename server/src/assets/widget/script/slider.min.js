var interval;
(function(d,X){d.fn.CircularSlider=function(t){var z=this;0!==z.find("div.jcs-panel").length&&d("#slider").empty();var A,I,x=!1,J=function(){I=new Date((new Date).getTime()+a.locationOffset);for(var b=I.getUTCHours(),c=1,e=0;12>e;e++){if(b==12+e||b==e)A=c;c+=6}18<=b&&23>=b||0<=b&&6>b?(x=!0,q.hide(),l.addClass("add-color")):x=!1;b=I.getUTCMinutes()+"";c=parseInt(b[0]);1<b.length&&(A+=c);72<A&&(A=1);return A},k=[],r={Circle:{drawShape:function(b,c){var e=2*c,d=e+"px",g=b.jcs,h=b.jcsValue,k=b.jcsPanel;
  a.value=J();g.css({width:d,height:d,"border-radius":d});k.css({"border-width":c/10+"px","border-radius":e+c/10+"px"});d=g.outerWidth()-g.innerWidth()+(h.outerWidth()-h.innerWidth());e=a.innerCircleRatio*c;d=c-e-d/2;h.css({width:2*e+"px",height:2*e+"px","font-size":e/5+"px",top:d+"px",left:d+"px"})},getCenter:function(b,a){return{x:b.left+a,y:b.top+a,r:a}},deg2Val:function(b){if(0>b||359<b)throw"Invalid angle "+b;return Math.floor((b+90)%360*(K/360))+a.min},val2Deg:function(b){if(b<a.min||b>a.max)throw"Invalid range "+
b;return(Math.floor(360/K*(b-a.min))-90)%360}}},p={radius:75,innerCircleRatio:"0.5",handleDist:100,min:0,max:359,value:56,clockwise:!0,labelSuffix:"",labelPrefix:"",shape:"Circle",touch:!0,animate:!0,animateDuration:360,selectable:!1,slide:function(a,c){},onSlideEnd:function(a,c){},uvIndex:[],locationOffset:1,forecastArray:[],formLabel:X},a=d.extend({},p,t);if((a.min|0)!==a.min)throw"Invalid min value : "+a.min;if((a.max|0)!==a.max)throw"Invalid max value : "+a.max;if((a.value|0)!==a.value)throw"Invalid initial value : "+
a.value;if(a.max<a.min)throw"Invalid range : "+a.max+"<"+a.min;a.value<a.min&&(a.value=a.min);a.value>a.max&&(a.value=a.max);a.labelSuffix||(a.labelSuffix=p.labelSuffix);a.labelPrefix||(a.labelPrefix=p.labelPrefix);a.formLabel&&!d.isFunction(a.formLabel)&&(a.formLabel=p.formLabel);a.shape||(a.shape=p.shape);if(!r[a.shape])throw"Invalid shape : "+a.shape;if(!a.innerCircleRatio||.1>a.innerCircleRatio||.9<a.innerCircleRatio)throw"Invalid innerCircleRatio. Expected: between 0.1 and 0.9, Found: "+a.innerCircleRatio;
  if((a.animateDuration|0)!==a.animateDuration||0>a.animateDuration)throw"Invalid animate duration(in ms) : "+a.animateDuration;if((a.handleDist|0)!==a.handleDist||0>=a.handleDist||100<a.handleDist)a.handleDist=p.handleDist;a.animate=!!a.animate;var K=a.max-a.min+1;t=d('<div class="jcs-panel"><div class="jcs"><div class="background"></div><div class="time-image"></div><span class="jcs-value"><span id="val"></span></span></div><div class="jcs-indicator"></div><div class="jcs-indicator-current"> </div></div>');
  t.appendTo(z);var u=Math.abs(parseInt(a.radius))||p.radius,m=t.find("div.jcs"),l=t.find("div.jcs-indicator"),q=t.find("div.jcs-indicator-current"),L=t.find("span.jcs-value"),B={jcs:m,jcsPanel:t,jcsIndicator:l,jcsIndicator2:q,jcsValue:L};r[a.shape].drawShape(B,u);(function(a,c){a.jcsIndicator.width()&&a.jcsIndicator.height()||(a.jcsIndicator.css({width:c/3+"px",height:c/3+"px"}),a.jcsIndicator2.css({width:"15px",height:c/2.8+"px"}))})(B,u);(function(){var b="";if(x){for(var c=30;36>c;c++)k.push(a.forecastArray[c]);
    for(c=24;30>=c;c++)k.push(a.forecastArray[c])}else{for(c=6;12>c;c++)k.push(a.forecastArray[c]);for(c=0;6>=c;c++)k.push(a.forecastArray[c])}for(c=0;c<k.length;c++)0<=k[c]&&.5>k[c]&&(b+="#4BB8A3,"),.5<=k[c]&&3>k[c]&&(b+="#86B37C,"),3<=k[c]&&6>k[c]&&(b+=" #FDAA2D,"),6<=k[c]&&8>k[c]&&(b+=" #FD7C34,"),8<=k[c]&&11>k[c]&&(b+="#DC5535,"),11<=k[c]&&(b+="#8C375D,");x?k.push(a.forecastArray[36]):k.push(a.forecastArray[12]);a.uvIndex=k;b=new ConicGradient({stops:b,repeating:!0});d(".jcs").addClass("background");
    d(".background").css({background:"url("+b.png+")","background-image":"url("+b.png+")"})})();var M=m.position(),D=m.outerWidth()-m.innerWidth(),N=l.outerWidth()-l.innerWidth(),O=(m.width()+D)/2,v=(l.width()+N)/2,h=r[a.shape].getCenter(M,O),y=!1,E=!1,Y=function(b){b=180*Math.atan2((b.offsetY||b.originalEvent.layerY)-h.y,(b.offsetX||b.originalEvent.layerX)-h.x)/Math.PI;var c=parseInt(0>b?360+b:b)%360;b=(r[a.shape].val2Deg(a.value)+360)%360;if(b!==c){var d=Math.min((c+360-b)%360,(b+360-c)%360);d||(d=
      180);var f=(c+360-b)%360===d,g=a.animateDuration/d,k=4,l=1;4<=g?k=parseInt(g):l=1<=g?4*parseInt(g):4/g;var m=b,n=parseInt(d/l);E=!0;var p=window.setInterval(function(){m+=f?l:-l;m=(m+360)%360;0>=--n&&(clearInterval(p),E=!1,m=c);C(r[a.shape].deg2Val(m));E||P()},k)}},Q=function(a){d("#val").html(Z(a));l.addClass("add-color");q.removeClass("add-border");var b=F-w;0>b&&(b*=-1);(0<=b&&15>=b||345<=b&&360>=b)&&!x&&(d("#val").html("<br><small id='liveUv' style='color:green'>Current Time</small>"),y||(l.removeClass("add-color"),
      q.addClass("add-border"),b=G(!1,n),l.css({top:b.y+"px",left:b.x+"px"})));R(a)},R=function(b){for(var c=0,e=a.max/12,f=a.min;f<a.max;f+=e){if(b>=f&&b<f+e){var g=a.uvIndex[c]+(a.uvIndex[c+1]-a.uvIndex[c])/6*(b-f);71<=f&&(g=a.uvIndex[c]+(a.uvIndex[0]-a.uvIndex[c])/6*(b-f));0>g&&(g=a.uvIndex[c+1],71<=f&&(g=a.uvIndex[0]));31<b&&37>b&&(g=a.uvIndex[c]+(a.uvIndex[13]-a.uvIndex[c])/6*(b-f));0<=g&&.5>g&&(d("#none").show(),d("#low").hide(),d("#moderate").hide(),d("#high").hide(),d("#veryhigh").hide(),d("#extreme").hide(),
      d("#image-in-text").html("No UV"));.5<=g&&3>g&&(d("#low").show(),d("#none").hide(),d("#moderate").hide(),d("#high").hide(),d("#veryhigh").hide(),d("#extreme").hide(),d("#image-in-text").html("Low UV"));3<=g&&6>g&&(d("#moderate").show(),d("#none").hide(),d("#low").hide(),d("#high").hide(),d("#veryhigh").hide(),d("#extreme").hide(),d("#image-in-text").html("Moderate UV"));6<=g&&8>g&&(d("#none").hide(),d("#low").hide(),d("#moderate").hide(),d("#high").show(),d("#veryhigh").hide(),d("#extreme").hide(),
      d("#image-in-text").html("High UV"));8<=g&&11>g&&(d("#veryhigh").show(),d("#none").hide(),d("#low").hide(),d("#moderate").hide(),d("#high").hide(),d("#extreme").hide(),d("#image-in-text").html("Very High UV"));11<=g&&(d("#extreme").show(),d("#none").hide(),d("#low").hide(),d("#moderate").hide(),d("#high").hide(),d("#veryhigh").hide(),d("#image-in-text").html("Extreme UV"))}c+=1}},w,S=function(b){b.stopPropagation();if(y&&!E){var c=Math.atan2((b.offsetY||b.originalEvent.layerY)-h.y,(b.offsetX||b.originalEvent.layerX)-
      h.x);b=180*c/Math.PI;var e=parseInt(0>b?360+b:b)%360,f=h.x+h.r*a.handleDist/100*Math.cos(c)-v,c=h.y+h.r*a.handleDist/100*Math.sin(c)-v;w=0>b?360+b:b;l.css({top:c+"px",left:f+"px"});b=r[a.shape].deg2Val(e);b=a.clockwise?b:a.max-b;b<a.min?b=a.min:b>a.max&&(b=a.max);Q(b);a.slide&&d.isFunction(a.slide)&&a.slide(z,b)}},T=!1,Z=function(b){a.value=b;for(var c,d=a.max,f=a.max/12,g=12,h=a.min;h<d;h+=f)b>=h&&b<h+f&&(c=b-h+"",c+="0",c=6<=g&&12>g?g+":"+c+" am":g+":"+c+" pm"),12==g?g=1:g++;b=c;T||(L.html(L.html()+
      a.labelSuffix),T=!0);return a.formLabel?a.formLabel(b):a.labelPrefix+b},U=!1,n,C=function(b){if((b|0)!==b)throw"Invalid input (expected integer) : "+b;var c=a.clockwise?b:a.max-b,e=r[a.shape].val2Deg(c);w=0>e?360+e:e;var f=e*Math.PI/180,e=h.x+h.r*a.handleDist/100*Math.cos(f)-v,f=h.y+h.r*a.handleDist/100*Math.sin(f)-v;l.css("top",f+"px");l.css("left",e+"px");U||(q.css("top",f+"px"),q.css("left",e+"px"),n=b,U=!0,aa());Q(b);a.slide&&d.isFunction(a.slide)&&a.slide(z,c)},H=0,aa=function(){this.interval&&
    clearInterval(this.interval);H=r[a.shape].val2Deg(n)-95;q.css({transform:"rotate("+H+"deg)"});V();memoryValue=J();this.interval=setInterval(function(){timeValue=J();timeValue!=memoryValue&&V();memoryValue=timeValue},15E3)},V=function(){n>a.max&&(n=a.min);var b=G(!0,n);H+=5;q.css({transform:"rotate("+H+"deg)"});var c=F-w;0>c&&(c*=-1);if(0<=c&&15>=c||345<=c&&360>=c)c=G(!1,n),l.css({top:c.y+"px",left:c.x+"px"}),w+=5,360<w&&(w=0),Q(n),R(n);q.css("top",b.y+"px");q.css("left",b.x+"px");n+=1;72<n&&(n=1)},
    F,G=function(b,c){var d=r[a.shape].val2Deg(a.clockwise?c:a.max-c);F=0>d?360+d:d;var f=d*Math.PI/180;b?(d=h.x+h.r*a.handleDist/100*Math.cos(f)-v+a.radius/7.9,f=h.y+h.r*a.handleDist/100*Math.sin(f)-v-a.radius/65.5):(d=h.x+h.r*a.handleDist/100*Math.cos(f)-v,f=h.y+h.r*a.handleDist/100*Math.sin(f)-v);return{x:d,y:f}};m.on("mousedown",function(a){y=!0;l.addClass("add-color");a.stopPropagation()});m.on("mouseup mouseleave",function(a){y=!1;var b=F-w;0>b&&(b*=-1);(0<=b&&15>=b||345<=b&&360>=b)&&!x&&(l.removeClass("add-color"),
    q.addClass("add-border"),b=G(!1,n),l.css({top:b.y+"px",left:b.x+"px"}));a.stopPropagation()});m.on("mousemove",S);m.on("click",function(b){b.stopPropagation();var c=(b.offsetX||b.originalEvent.layerX)-h.x,d=(b.offsetY||b.originalEvent.layerY)-h.y,c=Math.sqrt(c*c+d*d);u/1.75-c<=D||c>u/1.75?a.animate?Y(b):(y=!0,S(b),P()):P();y=!1});t.on("mouseup mousemove mousedown mouseleave",function(a){m.trigger(a)});var P=function(){if(a.onSlideEnd&&d.isFunction(a.onSlideEnd))a.onSlideEnd(z,a.value)},W="",p=function(a){var b=
    a.changedTouches;if(!(1<b.length)){var b=b[0],e=d(b.target);if(e.hasClass("jcs")||e.hasClass("time-image")){e.offset();e.width();e.height();var e=["touchstart","touchmove","touchend","touchcancel"],f=e.indexOf(a.type);-1!==f&&(f=["mousedown","mousemove","mouseup","mouseleave"][f],a.type===e[2]&&W===e[0]&&(f="click"),e=document.createEvent("MouseEvent"),a.preventDefault(),e.initMouseEvent(f,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(e),W=a.type)}}};
  a.touch&&(document.addEventListener("touchstart",p,!0),document.addEventListener("touchmove",p,!0),document.addEventListener("touchend",p,!0),document.addEventListener("touchcancel",p,!0));a.selectable||t.addClass("noselect");C(a.value||a.min);return d.extend({},this,{setValue:C,getValue:function(){return a.value},getSupportedShapes:function(){return Object.keys()},setRadius:function(b){if(isNaN(b))throw"Invalid Radius value: "+b;a.radius=Math.abs(parseInt(b));u=a.radius;r[a.shape].drawShape(B,u);
    B.jcsIndicator.css({width:u/3+"px",height:u/3+"px"});B.jcsIndicator2.css({width:"15px",height:u/2.8+"px"});M=m.position();D=m.outerWidth()-m.innerWidth();N=l.outerWidth()-l.innerWidth();O=(m.width()+D)/2;v=(l.width()+N)/2;h=r[a.shape].getCenter(M,O);C(a.value||a.min)},getRadius:function(){return a.radius},setRange:function(b,c){if((b|0)!==b)throw"Invalid min value : "+b;if((c|0)!==c)throw"Invalid max value : "+c;if(c<b)throw"Min range should be less than max";a.min=b;a.max=c;K=a.max-a.min+1;var d=
    a.value;if(d<b||d>c)d=b;C(d)},getAnimateDuration:function(){return a.animateDuration},setAnimateDuration:function(b){if((b|0)!==b||0>b)throw"Invalid animate duration(in ms) : "+b;a.animateDuration=b},setAnimate:function(b){a.animate=!!b},getAnimate:function(){return a.animate}})}})(jQuery);
